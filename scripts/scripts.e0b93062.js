"use strict";angular.module("testApp",["ngResource","ngRoute","ngDialog"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/contacts",{templateUrl:"views/contacts.html",controller:"ContactsCtrl"}).when("/admin",{templateUrl:"views/admin.html",controller:"AdminCtrl"}).otherwise({redirectTo:"/"})}]).run(["$rootScope","$location","sign",function(a,b,c){if(localStorage&&localStorage.getItem("test-auth")){var d={id:localStorage.getItem("test-id"),username:localStorage.getItem("test-username"),password:"password"};c(d).then(function(b){a.currentUser={auth:!0,id:b.id,username:b.username}})["catch"](function(){a.currentUser=null,b.path("/")})}else a.currentUser=null,b.path("/")}]),angular.module("testApp").controller("MainCtrl",["$scope",function(a){}]),angular.module("testApp").controller("ContactsCtrl",["$scope",function(a){}]),angular.module("testApp").controller("AdminCtrl",["$scope","$rootScope","$location",function(a,b,c){b.currentUser||c.path("/")}]),angular.module("testApp").controller("NavbarCtrl",["$rootScope","$scope","$location","sign","ngDialog",function(a,b,c,d,e){b.signout=function(){localStorage&&(localStorage.removeItem("test-auth"),localStorage.removeItem("test-id"),localStorage.removeItem("test-username")),a.currentUser=null,c.path("/")},b.signin=function(){e.open({template:"views/signin.html",controller:"SigninCtrl"}).closePromise.then(function(b){var d=b.value;d.id&&(a.currentUser={auth:!0,id:d.id,username:d.username},localStorage&&d.remember&&(localStorage.setItem("test-auth",!0),localStorage.setItem("test-id",d.id),localStorage.setItem("test-username",d.username)),c.path("/admin"))})}}]),angular.module("testApp").controller("SigninCtrl",["$scope","sign",function(a,b){a.user={remember:!1},a.error=!1,a.hideErr=function(){a.error=!1},a.doLogin=function(){a.submitted=!0;var c={username:a.user.username,password:a.user.password,remember:a.user.remember};b(c).then(function(b){a.closeThisDialog(b)})["catch"](function(){a.error=!0,a.$apply()})}}]),angular.module("testApp").factory("sign",function(){return function(a){return a.username&&a.password?Promise.resolve({id:1,username:a.username,remember:a.remember}):Promise.reject()}});